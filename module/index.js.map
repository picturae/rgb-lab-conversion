{"version":3,"file":"index.js","sources":["../src/data.js","../src/cases.js","../src/index.js"],"sourcesContent":["const whitePoint = {\n    D50: [0.96422, 1, 0.82521],\n    D65: [0.95047, 1, 1.08883],\n}\n\nconst rgbSpaces = {\n    AdobeRGB1998: {\n        gamma: 2.19921875,\n        matrix: {\n            D50: {\n                X: { red: 0.6097559, green: 0.2052401, blue: 0.149224 },\n                Y: { red: 0.3111242, green: 0.625656, blue: 0.0632197 },\n                Z: { red: 0.0194811, green: 0.0608902, blue: 0.7448387 },\n            },\n            D65: {\n                X: { red: 0.5767309, green: 0.185554, blue: 0.1881852 },\n                Y: { red: 0.2973769, green: 0.6273491, blue: 0.0752741 },\n                Z: { red: 0.0270343, green: 0.0706872, blue: 0.9911085 },\n            },\n        },\n        whitepoint: 'D65',\n    },\n    eciRGB_v2: {\n        gamma: 1.8,\n        matrix: {\n            D50: {\n                X: { red: 0.6502043, green: 0.1780774, blue: 0.1359384 },\n                Y: { red: 0.3202499, green: 0.6020711, blue: 0.0776791 },\n                Z: { red: 0.0, green: 0.067839, blue: 0.757371 },\n            },\n            D65: {\n                X: { red: 0.67, green: 0.21, blue: 0.14 },\n                Y: { red: 0.33, green: 0.71, blue: 0.08 },\n                Z: { red: 0, green: 0.08, blue: 0.78 },\n            },\n        },\n        whitepoint: 'D50',\n    },\n    sRGB: {\n        gamma: -2.2,\n        matrix: {\n            D50: {\n                X: { red: 0.4360747, green: 0.3850649, blue: 0.1430804 },\n                Y: { red: 0.2225045, green: 0.7168786, blue: 0.0606169 },\n                Z: { red: 0.0139322, green: 0.0971045, blue: 0.7141733 },\n            },\n            D65: {\n                X: { red: 0.4124564, green: 0.3575761, blue: 0.1804375 },\n                Y: { red: 0.2126729, green: 0.7151522, blue: 0.072175 },\n                Z: { red: 0.0193339, green: 0.119192, blue: 0.9503041 },\n            },\n        },\n        whitepoint: 'D65',\n    },\n}\n\nexport { whitePoint, rgbSpaces }\n","// for test and demo\nconst cases = {}\ncases.squares = [\n    {\n        rgb: [51, 51, 51],\n        eciRGB_v2: [20, 0, 0],\n        AdobeRGB1998: [20, 0, 0],\n        sRGB: [21, 0, 0],\n    },\n    {\n        rgb: [204, 204, 204],\n        eciRGB_v2: [80, 0, 0],\n        AdobeRGB1998: [83, 0, 0],\n        sRGB: [82, 0, 0],\n    },\n    {\n        rgb: [154, 51, 52],\n        eciRGB_v2: [40, 53, 34],\n        AdobeRGB1998: [42, 53, 33],\n        sRGB: [37, 44, 24],\n    },\n\n    {\n        rgb: [153, 51, 153],\n        eciRGB_v2: [43, 55, -26],\n        AdobeRGB1998: [44, 60, -31],\n        sRGB: [40, 52, -35],\n    },\n    {\n        rgb: [255, 255, 51],\n        eciRGB_v2: [97, -11, 99],\n        AdobeRGB1998: [98, -16, 96],\n        sRGB: [98, -15, 87],\n    },\n    {\n        rgb: [255, 102, 52],\n        eciRGB_v2: [69, 78, 79],\n        AdobeRGB1998: [69, 69, 68],\n        sRGB: [63, 58, 58],\n    },\n\n    {\n        rgb: [50, 51, 255],\n        eciRGB_v2: [39, 39, -100],\n        AdobeRGB1998: [36, 57, -104],\n        sRGB: [36, 55, -101],\n    },\n    {\n        rgb: [52, 255, 51],\n        eciRGB_v2: [83, -128, 74],\n        AdobeRGB1998: [84, -121, 79],\n        sRGB: [88, -75, 74],\n    },\n    {\n        rgb: [255, 51, 52],\n        eciRGB_v2: [65, 91, 77],\n        AdobeRGB1998: [64, 86, 63],\n        sRGB: [57, 75, 52],\n    },\n]\n\nexport { cases }\n","import { whitePoint, rgbSpaces } from './data.js'\nimport { cases } from './cases.js'\n\nconst rgbLabConversion = (function() {\n    const invS_RGB_XYZ = function(rgbArray, iccProfile) {\n        // Inverse sRGB Companding\n        var red = rgbArray[0] / 255\n        var green = rgbArray[1] / 255\n        var blue = rgbArray[2] / 255\n\n        if (red > 0.04045) {\n            red = Math.pow((red + 0.055) / 1.055, 2.4)\n        } else {\n            red = red / 12.92\n        }\n        if (green > 0.04045) {\n            green = Math.pow((green + 0.055) / 1.055, 2.4)\n        } else {\n            green = green / 12.92\n        }\n        if (blue > 0.04045) {\n            blue = Math.pow((blue + 0.055) / 1.055, 2.4)\n        } else {\n            blue = blue / 12.92\n        }\n\n        red = red * 100\n        green = green * 100\n        blue = blue * 100\n\n        var X =\n            red * iccProfile.matrix.D50.X.red +\n            green * iccProfile.matrix.D50.X.green +\n            blue * iccProfile.matrix.D50.X.blue\n        var Y =\n            red * iccProfile.matrix.D50.Y.red +\n            green * iccProfile.matrix.D50.Y.green +\n            blue * iccProfile.matrix.D50.Y.blue\n        var Z =\n            red * iccProfile.matrix.D50.Z.red +\n            green * iccProfile.matrix.D50.Z.green +\n            blue * iccProfile.matrix.D50.Z.blue\n        return [X, Y, Z]\n    }\n    const invEci_RGB_XYZ = function(rgbArray, iccProfile) {\n        // http://www.color.org/chardata/rgb/ecirgb.xalter\n        // Inverse eciRGB Companding\n        var red = rgbArray[0] / 255\n        var green = rgbArray[1] / 255\n        var blue = rgbArray[2] / 255\n\n        if (red > 0.008856) {\n            red = Math.pow((red + 0.16) / 1.16, 3)\n        } else {\n            red = red / 9.033\n        }\n        if (green > 0.008856) {\n            green = Math.pow((green + 0.16) / 1.16, 3)\n        } else {\n            green = green / 9.033\n        }\n        if (blue > 0.008856) {\n            blue = Math.pow((blue + 0.16) / 1.16, 3)\n        } else {\n            blue = blue / 9.033\n        }\n\n        red = red * 100\n        green = green * 100\n        blue = blue * 100\n\n        var X =\n            red * iccProfile.matrix.D50.X.red +\n            green * iccProfile.matrix.D50.X.green +\n            blue * iccProfile.matrix.D50.X.blue\n        var Y =\n            red * iccProfile.matrix.D50.Y.red +\n            green * iccProfile.matrix.D50.Y.green +\n            blue * iccProfile.matrix.D50.Y.blue\n        var Z =\n            red * iccProfile.matrix.D50.Z.red +\n            green * iccProfile.matrix.D50.Z.green +\n            blue * iccProfile.matrix.D50.Z.blue\n        return [X, Y, Z]\n    }\n    const invGamma_RGB_XYZ = function(rgbArray, iccProfile) {\n        // Inverse Gamma Companding\n        var red = rgbArray[0] / 255\n        var green = rgbArray[1] / 255\n        var blue = rgbArray[2] / 255\n\n        red = Math.pow(red, iccProfile.gamma)\n        green = Math.pow(green, iccProfile.gamma)\n        blue = Math.pow(blue, iccProfile.gamma)\n\n        red = red * 100\n        green = green * 100\n        blue = blue * 100\n\n        var X =\n            red * iccProfile.matrix.D50.X.red +\n            green * iccProfile.matrix.D50.X.green +\n            blue * iccProfile.matrix.D50.X.blue\n        var Y =\n            red * iccProfile.matrix.D50.Y.red +\n            green * iccProfile.matrix.D50.Y.green +\n            blue * iccProfile.matrix.D50.Y.blue\n        var Z =\n            red * iccProfile.matrix.D50.Z.red +\n            green * iccProfile.matrix.D50.Z.green +\n            blue * iccProfile.matrix.D50.Z.blue\n        return [X, Y, Z]\n    }\n\n    const XYZ_CIELab = function(xyzArray, whitePoint) {\n        var X = xyzArray[0] / whitePoint[0] / 100\n        var Y = xyzArray[1] / whitePoint[1] / 100\n        var Z = xyzArray[2] / whitePoint[2] / 100\n\n        if (X > 0.008856) X = Math.pow(X, 1 / 3)\n        else X = 7.787 * X + 16 / 116\n        if (Y > 0.008856) Y = Math.pow(Y, 1 / 3)\n        else Y = 7.787 * Y + 16 / 116\n        if (Z > 0.008856) Z = Math.pow(Z, 1 / 3)\n        else Z = 7.787 * Z + 16 / 116\n\n        var Lx = 116 * Y - 16\n        var ax = 500 * (X - Y)\n        var bx = 200 * (Y - Z)\n        return [Lx, ax, bx]\n    }\n\n    const RGB_XYZ = function(rgbArray, iccProfileName) {\n        let RGB_XYZ_function\n        switch (iccProfileName) {\n            case 'AdobeRGB1998':\n                RGB_XYZ_function = invGamma_RGB_XYZ\n                break\n            case 'eciRGB_v2':\n                RGB_XYZ_function = invEci_RGB_XYZ\n                break\n            case 'sRGB':\n                RGB_XYZ_function = invS_RGB_XYZ\n                break\n            default:\n                console.error(`iccProfile \"${iccProfileName}\" is not supported`)\n                return\n        }\n        return RGB_XYZ_function(rgbArray, rgbSpaces[iccProfileName])\n    }\n\n    const XYZ_Lab = function(xyzArray) {\n        // photoshop shows lab values with D50\n        return XYZ_CIELab(xyzArray, whitePoint.D50)\n    }\n\n    return {\n        rgb2XYZ: RGB_XYZ,\n        XYZ2Lab: XYZ_Lab,\n        rgb2Lab: function(rgbArray, iccProfileName) {\n            var xyzArray = RGB_XYZ(rgbArray, iccProfileName)\n            var labArray = XYZ_CIELab(xyzArray, whitePoint.D50)\n            return labArray\n        },\n        cases: cases,\n    }\n})()\n\nexport default rgbLabConversion\n"],"names":["whitePoint","rgbSpaces","AdobeRGB1998","gamma","matrix","D50","X","red","green","blue","Y","Z","D65","whitepoint","eciRGB_v2","sRGB","cases","squares","rgb","rgbLabConversion","invS_RGB_XYZ","rgbArray","iccProfile","Math","pow","invEci_RGB_XYZ","invGamma_RGB_XYZ","XYZ_CIELab","xyzArray","RGB_XYZ","iccProfileName","RGB_XYZ_function","console","error","rgb2XYZ","XYZ2Lab","rgb2Lab"],"mappings":"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"}